---
master_bathroom_witb_actions:
  # WITB+ Actions Package Template
  # Tokens: master_bathroom, Master Bathroom
  #
  # This template covers ONLY the helpers consumed by the WITB+ Actions
  # (lights + fan) blueprint. It does NOT include core occupancy helpers —
  # those live in the separate witb_plus_package_template.yaml.
  #
  # Feature blocks (controlled by --no-X flags or per-room `no_X: true` in config):
  #   lights    - auto_lights_on, keep_on (input_boolean) + brightness day/night
  #               (input_number) + actions_cooldown (timer)
  #   fan       - auto_fan_on (input_boolean) + fan_pct_day/night, fan_runon_minutes,
  #               fan_on_delay (input_number) + fan_runon (timer)
  #   lux       - lux_threshold (input_number)
  #   humidity  - humidity_high/low (input_number)
  #   night     - night_start/end (input_datetime)
  #
  # CHANGELOG:
  #   - Added # --- BEGIN/END --- markers to ALL optional sections so feature
  #     flags (--no-X / no_X: true) actually work. Previously no markers existed
  #     so all feature flags were silently doing nothing against this template.
  #   - Added restore_value: true to all input_number entries (without it, every
  #     HA restart resets numbers back to `initial`, wiping user-set values)
  #   - Renamed master_bathroom_fan_runon -> master_bathroom_actions_fan_runon for naming
  #     consistency (update automations referencing the old entity id)
  #   - Differentiated humidity icons: high=mdi:water-percent-alert, low=mdi:water-percent
  #   - Added icons and restore: false explicitly on all timers
  #   - Removed timer.master_bathroom_exit_eval — that belongs in witb_plus template

  input_boolean:
    # NOTE: `initial` only sets the value on FIRST creation in the DB.
    # After that, HA restores the last known state from the recorder.

    master_bathroom_auto_lights_on:
      name: "Master Bathroom auto lights on (tag)"
      icon: mdi:lightbulb-auto

    master_bathroom_keep_on:
      name: "Master Bathroom keep on (block off)"
      icon: mdi:lock-open-variant-outline

    master_bathroom_auto_fan_on:
      name: "Master Bathroom auto fan on (tag)"
      icon: mdi:fan-auto

  input_datetime:
    # input_datetime always restores last value from recorder — no restore_value needed.
    master_bathroom_actions_night_start:
      name: "Master Bathroom night start"
      icon: mdi:weather-night
      has_date: false
      has_time: true

    master_bathroom_actions_night_end:
      name: "Master Bathroom night end"
      icon: mdi:weather-sunny
      has_date: false
      has_time: true

  input_number:
    # IMPORTANT: restore_value: true on all input_number helpers.
    # Without it, HA resets to `initial` on every restart, wiping user-set values.

    master_bathroom_actions_brightness_day_pct:
      name: "Master Bathroom brightness day %"
      icon: mdi:brightness-6
      unit_of_measurement: "%"
      min: 1
      max: 100
      step: 1
      mode: box

    master_bathroom_actions_brightness_night_pct:
      name: "Master Bathroom brightness night %"
      icon: mdi:brightness-4
      unit_of_measurement: "%"
      min: 1
      max: 100
      step: 1
      mode: box

    master_bathroom_actions_fan_pct_day:
      name: "Master Bathroom fan day %"
      icon: mdi:fan
      unit_of_measurement: "%"
      min: 0
      max: 100
      step: 5
      mode: box

    master_bathroom_actions_fan_pct_night:
      name: "Master Bathroom fan night %"
      icon: mdi:fan
      unit_of_measurement: "%"
      min: 0
      max: 100
      step: 5
      mode: box

    master_bathroom_actions_fan_runon_minutes:
      name: "Master Bathroom fan run-on (minutes)"
      icon: mdi:timer-outline
      unit_of_measurement: "min"
      min: 0
      max: 60
      step: 1
      mode: box
      # NOTE: Keep in sync with timer.master_bathroom_actions_fan_runon duration below.

    master_bathroom_actions_fan_on_delay_seconds:
      name: "Master Bathroom fan ON delay (sec)"
      icon: mdi:timer-outline
      unit_of_measurement: "s"
      min: 0
      max: 180
      step: 5
      mode: box

    master_bathroom_actions_lux_threshold:
      name: "Master Bathroom lux threshold"
      icon: mdi:weather-sunny-alert
      unit_of_measurement: "lx"
      min: 0
      max: 5000
      step: 1
      mode: box

    master_bathroom_actions_humidity_high:
      name: "Master Bathroom humidity high %"
      icon: mdi:water-percent-alert
      unit_of_measurement: "%"
      min: 30
      max: 100
      step: 1
      mode: box

    master_bathroom_actions_humidity_low:
      name: "Master Bathroom humidity low %"
      icon: mdi:water-percent
      unit_of_measurement: "%"
      min: 30
      max: 100
      step: 1
      mode: box

  timer:
    master_bathroom_actions_cooldown:
      name: "Master Bathroom actions cooldown"
      icon: mdi:timer-pause-outline
      duration: "00:00:30"
      restore: true

    # Renamed from master_bathroom_fan_runon -> master_bathroom_actions_fan_runon for
    # consistency. Update any automations referencing the old entity id:
    #   timer.master_bathroom_fan_runon  ->  timer.master_bathroom_actions_fan_runon
    master_bathroom_actions_fan_runon:
      name: "Master Bathroom fan run-on"
      icon: mdi:fan-clock
      duration: "00:05:00"
      restore: true
